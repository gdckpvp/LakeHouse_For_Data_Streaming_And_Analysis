CREATE SCHEMA IF NOT EXISTS delta.bronze WITH (location='s3a://test/bronze/')
CREATE SCHEMA IF NOT EXISTS delta.silver WITH (location='s3a://test/silver/')
CREATE SCHEMA IF NOT EXISTS delta.gold WITH (location='s3a://test/gold/')
CREATE TABLE IF NOT EXISTS delta.silver.fact(coin_id INTEGER,date_id INTEGER,time_id INTEGER,price DOUBLE,market_cap DOUBLE,change_percent_last_day DOUBLE,average_1minute DOUBLE,created_at VARCHAR) WITH (partitioned_by = ARRAY['coin_id'])
CREATE TABLE IF NOT EXISTS delta.bronze.bitcoin_stg(bitcoin DOUBLE,timestamp TIMESTAMP(3) with time zone,average_1minute DOUBLE)
CREATE TABLE IF NOT EXISTS delta.bronze.ethereum_stg(ethereum DOUBLE,timestamp TIMESTAMP(3) with time zone,average_1minute DOUBLE)
CREATE TABLE IF NOT EXISTS delta.silver.dimcoin(surrogate_key BIGINT,coin_id INTEGER,symbol VARCHAR,name VARCHAR,supply DOUBLE,maxSupply DOUBLE,volume24h DOUBLE,hash VARCHAR,start_date DATE,end_date DATE,is_current VARCHAR(1))
CREATE TABLE IF NOT EXISTS delta.silver.dimtime(id INTEGER,Time VARCHAR,Hour VARCHAR,Minute VARCHAR,Second VARCHAR,Time24 VARCHAR,Hour24 VARCHAR,AmPm VARCHAR)
CREATE TABLE IF NOT EXISTS delta.silver.dimdate(id INTEGER,CalendarDate DATE,CalendarYear INTEGER,CalendarMonth VARCHAR,MonthOfYear INTEGER,CalendarDay VARCHAR,DayOfWeek INTEGER,DayOfMonth INTEGER,DayOfYear INTEGER,WeekOfYearIso INTEGER)
CREATE TABLE IF NOT EXISTS delta.silver.dailybitcoin(Date DATE,Open DOUBLE,High DOUBLE,Low DOUBLE,Close DOUBLE,AdjClose DOUBLE,Volume BIGINT)
CREATE TABLE IF NOT EXISTS delta.silver.dailyethereum(Date DATE,Open DOUBLE,High DOUBLE,Low DOUBLE,Close DOUBLE,AdjClose DOUBLE,Volume BIGINT)